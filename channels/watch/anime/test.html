<link href="https://vjs.zencdn.net/8.6.1/video-js.css" rel="stylesheet" />
<link href="https://mikasa-ackerman-cdn.pages.dev/player/custom-style.css" rel="stylesheet" />
<script src="https://vjs.zencdn.net/8.6.1/video.min.js"></script>

<video id="myPlayer" class="video-js vjs-default-skin" controls width="640" height="360" preload="auto">
  <source src="https://amg02159-kcglobal-amg02159c1-samsung-in-521.playouts.now.amagi.tv/playlist/amg02159-kcglobal-animax-samsungin/playlist.m3u8" type="application/x-mpegURL">
</video>

<!-- Dropdown for Quality Selection -->
<div id="quality-selector">
  <select id="quality-dropdown">
    <!-- Options will be populated here dynamically -->
  </select>
</div>

<script>
  var player = videojs('myPlayer');

  player.ready(function() {
    var hls = player.tech().hls;

    // Wait for metadata to load and available qualities to be fetched
    hls.on('loadedmetadata', function () {
      var qualityDropdown = document.getElementById('quality-dropdown');
      
      // Get available quality levels from HLS
      var levels = hls.levels;
      
      // Populate the dropdown with available quality options
      levels.forEach(function(level, index) {
        var option = document.createElement('option');
        option.value = index;
        option.textContent = `${level.height}p (${Math.round(level.bitrate / 1000)} kbps)`;
        qualityDropdown.appendChild(option);
      });

      // Event listener to change quality on selection
      qualityDropdown.addEventListener('change', function() {
        var selectedLevel = qualityDropdown.value;
        hls.startLevel = parseInt(selectedLevel); // Set the selected quality level
      });
    });

    // Handling subtitles (if available in the stream)
    hls.on('manifestLoaded', function(event, data) {
      if (data.subtitles && data.subtitles.length > 0) {
        var subtitleTracks = data.subtitles;
        
        subtitleTracks.forEach(function(track) {
          player.addRemoteTextTrack({
            kind: 'subtitles',
            label: track.name,
            language: track.language,
            src: track.uri,
            default: track.default
          });
        });
      }
    });
  });
            </script>
            
