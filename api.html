<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>Web Upload - VidGuard</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Custom Styles for simplicity -->
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            margin: 0;
            padding: 0;
        }

        .container {
            width: 80%;
            max-width: 1200px;
            margin: 40px auto;
            padding: 20px;
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        h2 {
            text-align: center;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        #filepond {
            margin-bottom: 20px;
        }

        #uploadURLs {
            height: 200px;
            padding: 10px;
            font-family: monospace;
            white-space: pre-wrap;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .btn {
            padding: 10px 15px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }

        .btn:hover {
            background-color: #0056b3;
        }

        .btn:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            font-size: 14px;
            color: #888;
        }
    </style>

    <!-- FilePond Styles -->
    <link href="https://cdn.jsdelivr.net/npm/filepond/dist/filepond.min.css" rel="stylesheet">

    <!-- FilePond JS -->
    <script src="https://cdn.jsdelivr.net/npm/filepond/dist/filepond.min.js"></script>

</head>

<body>

    <div class="container">
        <h2>Upload Video to VidGuard</h2>

        <div class="form-group">
            <label for="filepond">Choose Video File</label>
            <input type="file" id="filepond" name="file" multiple />
        </div>

        <div class="form-group">
            <label for="folder">Save to Folder</label>
            <select id="folder" name="folder" class="form-control">
                <option value="86555">anime</option>
                <option value="86556">test</option>
            </select>
        </div>

        <div class="form-group">
            <label for="uploadURLs">Uploaded Video URLs</label>
            <textarea id="uploadURLs" class="form-control" rows="8" readonly></textarea>
        </div>

        <button id="copyURLs" class="btn">Copy URLs</button>

    </div>

    <script>
        // Initialize FilePond
        const api_key = "9bgr80DjkwmMq75LjXmEXPBYV2JWLvZa3z"; // Hardcoded API key

        // Set up FilePond to handle file uploads
        FilePond.create(document.querySelector('#filepond'), {
            labelTapToUndo: "Click to cancel",
            maxParallelUploads: 5,
            chunkUploads: true,
            chunkSize: 1024 * 1024 * 85, // 85MB chunks
            chunkForce: true,
            server: {
                url: '/v1/upload/server?chunk=true&key=' + api_key,
                process: {
                    ondata: (fd) => {
                        fd.append('key', api_key); // Append API key to the file data
                        return fd;
                    },
                },
                patch: {
                    url: '?key=' + api_key + '&id=',
                    onupdate: (url) => {
                        return url + '&folder=' + document.getElementById('folder').value;
                    },
                    onload: (response) => {
                        try {
                            const json = JSON.parse(response);
                            const url = json.result.URL;
                            // Append the video URL to the textarea
                            document.getElementById('uploadURLs').value += url + "\n";
                        } catch (e) {
                            console.error("Error parsing response:", e);
                        }
                    },
                },
            },
        });

        // Copy URLs to clipboard
        document.getElementById('copyURLs').addEventListener('click', function () {
            const text = document.getElementById('uploadURLs').value;
            const tempTextArea = document.createElement('textarea');
            tempTextArea.value = text;
            document.body.appendChild(tempTextArea);
            tempTextArea.select();
            document.execCommand('copy');
            document.body.removeChild(tempTextArea);
            alert("URLs copied to clipboard!");
        });

    </script>

    <footer class="footer">
        <p>&copy; 2025 VidGuard. All rights reserved.</p>
    </footer>

</body>

</html>
